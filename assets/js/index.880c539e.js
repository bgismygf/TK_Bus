(function(t){function e(e){for(var a,c,r=e[0],s=e[1],u=e[2],p=0,f=[];p<r.length;p++)c=r[p],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&f.push(o[c][0]),o[c]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);l&&l(e);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(a=!1)}a&&(i.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},o={index:0},i=[];function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/tk_bus/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"4f66":function(t,e,n){"use strict";n("f7c4")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23");function o(t,e,n,o,i,c){var r=Object(a["x"])("router-view");return Object(a["s"])(),Object(a["e"])("div",null,[Object(a["h"])(r)])}var i=n("1da1"),c=(n("96cf"),n("d3b7"),n("6c2d")),r=Object(a["u"])({listSwitch:"home",routeNumber:"",routeData:[],routeName:"",direction:0,directionName:"",busArrivalData:[],oneWay:!1,myLocation:{},nearestStationDisplay:[],frequentData:[],frequentJudge:[]}),s=function(){var t="41ece8284df9490b85929bce0820b67a",e="6dsr-IWEI6Zf2HVmsdal0dUthnU",n=(new Date).toGMTString(),a=new c["a"]("SHA-1","TEXT");a.setHMACKey(e,"TEXT"),a.update("x-date: ".concat(n));var o=a.getHMAC("B64"),i='hmac username="'+t+'", algorithm="hmac-sha1", headers="x-date", signature="'+o+'"';return{Authorization:i,"X-Date":n}},u=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e){t.next=3;break}return r.routeData=[],t.abrupt("return");case 3:return n="https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Kaohsiung/".concat(e,"?$format=JSON"),t.next=6,fetch(n,{headers:s()}).then((function(t){return t.json()}));case 6:a=t.sent,r.routeData=a;case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(){r.frequentJudge=JSON.parse(localStorage.getItem("frequentJudge"))||[]},p={state:r,fetchKhLocation:u,getFrequentJudge:l},f={name:"App",setup:function(){Object(a["t"])("khStore",p),p.getFrequentJudge()}},d=(n("4f66"),n("6b0d")),m=n.n(d);const b=m()(f,[["render",o]]);var h=b,v=n("6c02"),O={class:"home"},j={class:"d-flex",style:{height:"100vh"}},S={class:"d-flex flex-column bg-main",style:{width:"70px"}},g={class:"nav nav-pills flex-column mb-auto text-center"},y={class:"nav-item"},x={key:0},w={key:1,class:"fas fa-home"},N={class:"nav-item"},k=Object(a["f"])("i",{class:"fas fa-bus"},null,-1),L=[k],q={class:"nav-item"},T=Object(a["f"])("i",{class:"fas fa-map-marked-alt"},null,-1),D=[T],C={class:"nav-item"},R=Object(a["f"])("i",{class:"fas fa-check-circle"},null,-1),J=[R],P={class:"row g-0 w-100"},A={class:"col-md-7 col-lg-5"},z={key:0,class:"bg-light"},B=Object(a["g"])('<h1 class="h5 text-main text-center py-3 border-bottom border-3">TK Bus 高雄公車查詢</h1><h2 class="h5 text-main text-center my-4">服務內容</h2><div class="px-3 datalist" style="height:calc(100vh - 180px);"><div class="row mb-4 g-0"><div class="col-4"><div class="d-flex flex-column text-second text-center"><i class="fas fa-bus" style="font-size:26px;"></i><h3 class="h6 mt-2">搜尋公車路線</h3></div></div><div class="col-8"><p class="text-main">透過搜尋路線，得到公車路線，以及目前公車時間。</p></div></div><div class="row mb-4 g-0"><div class="col-4"><div class="d-flex flex-column text-second text-center"><i class="fas fa-map-marked-alt" style="font-size:26px;"></i><h3 class="h6 mt-2">周圍站點搜尋</h3></div></div><div class="col-8"><p class="text-main">透過電腦、手機等裝置的 GPS 定位出您的所在點，與您附近的車站。</p></div></div><div class="row mb-4 g-0"><div class="col-4"><div class="d-flex flex-column text-second text-center"><i class="fas fa-check-circle" style="font-size:26px;"></i><h3 class="h6 mt-2">常搭站點快捷</h3></div></div><div class="col-8"><p class="text-main">透過小圓點，讓您在下一次搭車時，從此處快速獲取常搭乘的班次資訊。</p></div></div><div class="row mb-4 g-0"><div class="col-4"><div class="text-second text-center"><div class="circle point mx-auto"></div><h3 class="h6 mt-2">儲存小圓點</h3></div></div><div class="col-8"><p class="text-main">站點名稱旁的圓點，按下後可加入到 &quot;常搭站點快捷&quot;。</p></div></div><div class="row mb-4 g-0"><div class="col-4"><div class="d-flex flex-column text-second text-center"><i class="far fa-clock" style="font-size:26px;"></i><h3 class="h6 mt-2">即時更新時間</h3></div></div><div class="col-8"><p class="text-main">30 秒一次即時更新公車預計到達時間，讓您準確時間搭車。</p></div></div></div>',3),_=[B],E={key:1,class:"bg-light py-3 ps-3 pe-2"},M={class:"text-main text-center"},Z={class:"d-flex justify-content-between align-items-center mb-4"},F=Object(a["f"])("i",{class:"fas fa-reply"},null,-1),K=[F],H={class:"text-main"},I=["disabled"],W=Object(a["f"])("i",{class:"fas fa-retweet"},null,-1),V=[W],X={class:"datalist px-2",style:{height:"calc(100vh - 151px)"}},U=["onClick"],G={key:0,class:"line"},$=["onClick"],Q={key:0,class:"circle point"},Y={key:1,class:"circle border-0"},tt=Object(a["f"])("i",{class:"fas fa-check-circle position-absolute text-second",style:{"font-size":"25px",top:"0px",right:"0px"}},null,-1),et=[tt],nt={class:"mx-4",style:{"font-size":"17px"}},at={class:"mb-0 me-auto",style:{"font-size":"17px"}},ot={class:"d-flex mb-3"},it={class:"bg-light p-2 rounded datalist",style:{height:"calc(100vh - 107px)"}},ct={key:0,class:"list-unstyled"},rt=["onClick"],st={class:"card border-0 shadow-sm"},ut={class:"card-header bg-second px-2 py-1 text-light"},lt={class:"card-body px-2 py-1 text-main"},pt={class:"d-flex align-items-center mb-2"},ft=Object(a["f"])("h5",{class:"text-main me-auto mb-0"},"您附近的車站有...",-1),dt=Object(a["f"])("i",{class:"fas fa-map-marker-alt"},null,-1),mt=[dt],bt={class:"bg-light p-2 rounded datalist",style:{height:"calc(100vh - 107px)"}},ht={class:"list-unstyled"},vt=["onClick"],Ot={class:"card border-0 shadow-sm"},jt={class:"card-header bg-second px-2 py-1 text-light"},St={class:"card-body px-2 py-1 text-main"},gt={class:"mb-1"},yt={class:"d-flex align-items-center mb-1"},xt={class:"me-auto"},wt=["onClick"],Nt={key:0,class:"circle point"},kt={key:1,class:"circle border-0"},Lt=Object(a["f"])("i",{class:"fas fa-check-circle position-absolute text-second",style:{"font-size":"25px",top:"0px",right:"0px"}},null,-1),qt=[Lt],Tt={class:"mb-1"},Dt=Object(a["f"])("div",{class:"d-flex align-items-center mb-2"},[Object(a["f"])("h5",{class:"text-main mb-0"},"您常搭的車站有...")],-1),Ct={class:"bg-light p-2 rounded datalist",style:{height:"calc(100vh - 107px)"}},Rt={class:"list-unstyled"},Jt=["onClick"],Pt={class:"card border-0 shadow-sm"},At={class:"card-header bg-second px-2 py-1 text-light d-flex"},zt={class:"text-light mb-0"},Bt=["onClick"],_t=Object(a["f"])("i",{class:"fas fa-times-circle"},null,-1),Et=[_t],Mt={class:"card-body px-2 py-1 text-main"},Zt={class:"mb-1"},Ft={class:"mb-1"},Kt={class:"mb-1"},Ht=Object(a["f"])("div",{class:"col-md-5 col-lg-7 d-none d-md-block"},[Object(a["f"])("div",{id:"map"})],-1);function It(t,e,n,o,i,c){return Object(a["s"])(),Object(a["e"])("div",O,[Object(a["f"])("div",j,[Object(a["f"])("div",S,[Object(a["f"])("ul",g,[Object(a["f"])("li",y,[Object(a["f"])("a",{href:"#",class:"d-inline-block h5 w-100 py-3 mb-0 nav-main text-decoration-none",onClick:e[0]||(e[0]=Object(a["F"])((function(t){return o.listSwitchControl("home")}),["prevent"]))},["home"!==t.listSwitch?(Object(a["s"])(),Object(a["e"])("span",x,"TK")):(Object(a["s"])(),Object(a["e"])("i",w))])]),Object(a["f"])("li",N,[Object(a["f"])("a",{href:"#",class:Object(a["n"])(["d-inline-block h5 w-100 py-3 mb-0 nav-main",{"nav-active":"searchRoute"===t.listSwitch||"searchRoute_stop"===t.listSwitch}]),onClick:e[1]||(e[1]=Object(a["F"])((function(t){return o.listSwitchControl("searchRoute")}),["prevent"]))},L,2)]),Object(a["f"])("li",q,[Object(a["f"])("a",{href:"#",class:Object(a["n"])(["d-inline-block h5 w-100 py-3 mb-0 nav-main",{"nav-active":"nearbyStation"===t.listSwitch}]),onClick:e[2]||(e[2]=Object(a["F"])((function(){return o.gps&&o.gps.apply(o,arguments)}),["prevent"]))},D,2)]),Object(a["f"])("li",C,[Object(a["f"])("a",{href:"#",class:Object(a["n"])(["d-inline-block h5 w-100 py-3 mb-0 nav-main",{"nav-active":"frequentStop"===t.listSwitch}]),onClick:e[3]||(e[3]=Object(a["F"])((function(){return o.frequenStopMark&&o.frequenStopMark.apply(o,arguments)}),["prevent"]))},J,2)])])]),Object(a["f"])("div",P,[Object(a["f"])("div",A,["home"===t.listSwitch?(Object(a["s"])(),Object(a["e"])("div",z,_)):Object(a["d"])("",!0),"home"!==t.listSwitch?(Object(a["s"])(),Object(a["e"])("div",E,["searchRoute_stop"===t.listSwitch?(Object(a["s"])(),Object(a["e"])(a["a"],{key:0},[Object(a["f"])("h5",M,Object(a["z"])(t.routeName),1),Object(a["f"])("div",Z,[Object(a["f"])("button",{type:"button",class:"btn btn-outline-second btn-sm",onClick:e[4]||(e[4]=function(){return o.goBacklist&&o.goBacklist.apply(o,arguments)})},K),Object(a["f"])("span",H,"往 "+Object(a["z"])(t.directionName),1),Object(a["f"])("button",{type:"button",class:"btn btn-outline-second btn-sm",onClick:e[5]||(e[5]=function(){return o.directionSwitch&&o.directionSwitch.apply(o,arguments)}),disabled:t.oneWay},V,8,I)]),Object(a["f"])("div",X,[(Object(a["s"])(!0),Object(a["e"])(a["a"],null,Object(a["w"])(t.busArrivalData,(function(e,n){return Object(a["s"])(),Object(a["e"])("a",{href:"#",class:"d-flex align-items-center mb-3 position-relative text-decoration-none text-main",key:e,onClick:function(t){return o.itemPopup(e)}},[Object(a["f"])("div",null,[n+1!==t.busArrivalData.length?(Object(a["s"])(),Object(a["e"])("div",G)):Object(a["d"])("",!0),Object(a["f"])("a",{href:"#",onClick:Object(a["F"])((function(t){return o.addFrequentStop(e)}),["stop","prevent"])},[!1===e.frequentStop?(Object(a["s"])(),Object(a["e"])("div",Q)):(Object(a["s"])(),Object(a["e"])("div",Y,et))],8,$)]),Object(a["f"])("span",nt,Object(a["z"])(e.srrivalDisplay),1),Object(a["f"])("h6",at,Object(a["z"])(e.stopName),1)],8,U)})),128))])],64)):Object(a["d"])("",!0),"searchRoute"===t.listSwitch?(Object(a["s"])(),Object(a["e"])(a["a"],{key:1},[Object(a["f"])("div",ot,[Object(a["E"])(Object(a["f"])("input",{type:"text",class:"form-control input-main","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default",placeholder:"請輸入路線編號","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.routeNumber=e}),onInput:e[7]||(e[7]=function(){return o.fliterRouteNumber&&o.fliterRouteNumber.apply(o,arguments)})},null,544),[[a["C"],t.routeNumber]])]),Object(a["f"])("div",it,[t.routeData.length>0?(Object(a["s"])(),Object(a["e"])("ul",ct,[(Object(a["s"])(!0),Object(a["e"])(a["a"],null,Object(a["w"])(t.routeData,(function(t){return Object(a["s"])(),Object(a["e"])("li",{class:"mb-3 text-light border-light",key:t},[Object(a["f"])("a",{href:"#",class:"text-decoration-none",onClick:Object(a["F"])((function(e){return o.routeSwitchToStop(t.RouteName.Zh_tw)}),["prevent"])},[Object(a["f"])("div",st,[Object(a["f"])("div",ut,Object(a["z"])(t.RouteName.Zh_tw),1),Object(a["f"])("div",lt,Object(a["z"])(t.DepartureStopNameZh)+" - "+Object(a["z"])(t.DestinationStopNameZh),1)])],8,rt)])})),128))])):Object(a["d"])("",!0)])],64)):Object(a["d"])("",!0),"nearbyStation"===t.listSwitch?(Object(a["s"])(),Object(a["e"])(a["a"],{key:2},[Object(a["f"])("div",pt,[ft,Object(a["f"])("a",{class:"text-decoration-none text-main",style:{"font-size":"26px"},href:"#",onClick:e[8]||(e[8]=Object(a["F"])((function(){return o.gps&&o.gps.apply(o,arguments)}),["prevent"]))},mt)]),Object(a["f"])("div",bt,[Object(a["f"])("ul",ht,[(Object(a["s"])(!0),Object(a["e"])(a["a"],null,Object(a["w"])(t.nearestStationDisplay,(function(t){return Object(a["s"])(),Object(a["e"])("li",{class:"mb-3 text-light border-light",key:t},[Object(a["f"])("a",{href:"#",class:"text-decoration-none",onClick:Object(a["F"])((function(e){return o.itemPopup(t)}),["prevent"])},[Object(a["f"])("div",Ot,[Object(a["f"])("div",jt,Object(a["z"])(t.routeName),1),Object(a["f"])("div",St,[Object(a["f"])("p",gt,"方向："+Object(a["z"])(t.directionStopName),1),Object(a["f"])("div",yt,[Object(a["f"])("span",xt,"站名："+Object(a["z"])(t.stopName),1),Object(a["f"])("a",{href:"#",onClick:Object(a["F"])((function(e){return o.addFrequentStop(t)}),["stop","prevent"])},[!1===t.frequentStop?(Object(a["s"])(),Object(a["e"])("div",Nt)):(Object(a["s"])(),Object(a["e"])("div",kt,qt))],8,wt)]),Object(a["f"])("p",Tt,"時間："+Object(a["z"])(t.srrivalDisplay),1)])])],8,vt)])})),128))])])],64)):Object(a["d"])("",!0),"frequentStop"===t.listSwitch?(Object(a["s"])(),Object(a["e"])(a["a"],{key:3},[Dt,Object(a["f"])("div",Ct,[Object(a["f"])("ul",Rt,[(Object(a["s"])(!0),Object(a["e"])(a["a"],null,Object(a["w"])(t.frequentData,(function(t){return Object(a["s"])(),Object(a["e"])("li",{class:"mb-3 text-light border-light",key:t},[Object(a["f"])("a",{href:"#",class:"text-decoration-none",onClick:Object(a["F"])((function(e){return o.itemPopup(t)}),["prevent","stop"])},[Object(a["f"])("div",Pt,[Object(a["f"])("div",At,[Object(a["f"])("p",zt,Object(a["z"])(t.routeName),1),Object(a["f"])("a",{href:"#",class:"text-light ms-auto",onClick:Object(a["F"])((function(e){return o.removeFrequentStop(t)}),["prevent","stop"])},Et,8,Bt)]),Object(a["f"])("div",Mt,[Object(a["f"])("p",Zt,"方向："+Object(a["z"])(t.directionStopName),1),Object(a["f"])("p",Ft,"站名："+Object(a["z"])(t.stopName),1),Object(a["f"])("p",Kt,"時間："+Object(a["z"])(t.srrivalDisplay),1)])])],8,Jt)])})),128))])])],64)):Object(a["d"])("",!0)])):Object(a["d"])("",!0)]),Ht])])])}var Wt=n("5530"),Vt=(n("d81d"),n("4de4"),n("a434"),n("159b"),n("a630"),n("3ca3"),n("a15b"),n("e9c4"),n("e11e")),Xt=n.n(Vt),Ut={name:"home",setup:function(){var t,e=Object(a["l"])("khStore"),n=e.state,o=function(t){n.listSwitch=t,T(),q()},r=function(){e.fetchKhLocation(n.routeNumber)},s=function(){n.direction?n.direction=0:n.direction=1,t.eachLayer((function(e){e instanceof Xt.a.Marker&&t.removeLayer(e)})),f(n.routeName)},u=function(t){n.listSwitch="searchRoute_stop",n.routeName=t,f(t)},l=function(){n.listSwitch="searchRoute",t.eachLayer((function(e){e instanceof Xt.a.Marker&&(t.removeLayer(e),t.closePopup())}))};Object(a["q"])((function(){t=Xt.a.map("map",{center:[22.62,120.31],minZoom:8,maxZoom:18,zoom:14,zoomControl:!0,attributionControl:!1}),Xt.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(t),setInterval(p,3e4)}));var p=function(){"searchRoute_stop"===n.listSwitch&&f(n.routeName),"nearbyStation"===n.listSwitch&&j(),"frequentStop"===n.listSwitch&&x()},f=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a="https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/Kaohsiung/".concat(e,"?&$format=JSON"),t.next=3,fetch(a,{headers:b()}).then((function(t){return t.json()}));case 3:o=t.sent,1===o.length?(n.oneWay=!0,n.direction=0):n.oneWay=!1,i=o[n.direction].Stops.length-1,c={routeName:o[n.direction].RouteName.Zh_tw,stopName:o[n.direction].Stops},n.directionName=o[n.direction].Stops[i].StopName.Zh_tw,d(e,c);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a,o){var i,c,r,s,u,l,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/Kaohsiung/".concat(a,"?&$format=JSON"),e.next=3,fetch(i,{headers:b()}).then((function(t){return t.json()}));case 3:c=e.sent,r=c.filter((function(t){return t.Direction===n.direction||255===t.Direction})),n.busArrivalData!==[]&&n.busArrivalData.splice(0,n.busArrivalData.length),o.stopName.forEach((function(t){r.forEach((function(e){t.StopName.Zh_tw===e.StopName.Zh_tw&&o.routeName===e.RouteName.Zh_tw&&n.busArrivalData.push({direction:e.Direction,directionStopName:n.directionName,routeName:e.RouteName.Zh_tw,stopName:e.StopName.Zh_tw,stopStatus:e.StopStatus,isLastBus:e.IsLastBus||"",nextBusTime:e.NextBusTime||"",estimateTime:e.EstimateTime/60||"",srrivalDisplay:h(e),positionLat:t.StopPosition.PositionLat,positionLon:t.StopPosition.PositionLon,frequentStop:m({stopName:e.StopName.Zh_tw,routeName:n.routeName,direction:e.Direction})})}))})),s=n.busArrivalData.length,u=Math.round(s/2),1===u&&(u=0),l=[n.busArrivalData[u].positionLat,n.busArrivalData[u].positionLon],p=Math.round(t.distance([n.busArrivalData[0].positionLat,n.busArrivalData[0].positionLon],[n.busArrivalData[s-1].positionLat,n.busArrivalData[s-1].positionLon])),f=p>3e3?13:14,q(),L(n.busArrivalData),t.setView(l,f);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(t){var e=n.frequentJudge.length;if(0===e)return!1;for(var a=0;a<e;a++)if(n.frequentJudge[a].stopName===t.stopName&&n.frequentJudge[a].routeName===t.routeName&&n.frequentJudge[a].direction===t.direction)return!0;return!1},b=function(){var t="41ece8284df9490b85929bce0820b67a",e="6dsr-IWEI6Zf2HVmsdal0dUthnU",n=(new Date).toGMTString(),a=new c["a"]("SHA-1","TEXT");a.setHMACKey(e,"TEXT"),a.update("x-date: ".concat(n));var o=a.getHMAC("B64"),i='hmac username="'+t+'", algorithm="hmac-sha1", headers="x-date", signature="'+o+'"';return{Authorization:i,"X-Date":n}},h=function(t){var e=t.EstimateTime/60||"";return 0===t.StopStatus?""===e?"進站中":1===e?"即將進站":"".concat(e," 分"):1===t.StopStatus?""===e&&""===t.NextBusTime||!t.NextBusTime?"尚未發車":v(t.NextBusTime)||"":3===t.StopStatus?"末班駛離":2===t.StopStatus?"交管不停靠":4===t.StopStatus?"今日未營運":void 0},v=function(t){var e=Array.from(t),n=e.indexOf("T");return e.filter((function(t,e){return e>n&&e<n+6})).join("")},O=function(e){var n=[e.positionLat,e.positionLon],a=Xt.a.popup({minWidth:200});a.setLatLng([e.positionLat,e.positionLon]),a.setContent("".concat(e.stopName)),t.openPopup(a),t.setView(n,16)},j=function(e){n.listSwitch="nearbyStation",t.locate({setView:!0,watch:!1}),t.on("locationfound",S)},S=function(e){q(),T(),n.nearestStationDisplay=[],n.myLocation={positionLat:e.latlng.lat,positionLon:e.latlng.lng};Xt.a.marker([n.myLocation.positionLat,n.myLocation.positionLon]).addTo(t),Xt.a.circle([n.myLocation.positionLat,n.myLocation.positionLon],{color:"red",fillColor:"#f03",fillOpacity:.5,radius:200}).addTo(t);var a=.0013376,o={latTop:n.myLocation.positionLat+a,latDown:n.myLocation.positionLat-a,lngLeft:n.myLocation.positionLon-a,lngRight:n.myLocation.positionLon+a};y(o)},g=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/Kaohsiung?%24format=JSON",t.next=3,fetch(a,{headers:b()}).then((function(t){return t.json()}));case 3:for(o=t.sent,i=0;i<e.length;i++)for(c=0;c<o.length;c++)e[i].stopName===o[c].StopName.Zh_tw&&e[i].direction===o[c].Direction&&e[i].routeName===o[c].SubRouteName.Zh_tw&&n.nearestStationDisplay.push({direction:e[i].direction,positionLat:e[i].position[0],positionLon:e[i].position[1],stopName:e[i].stopName,routeName:e[i].routeName,directionStopName:e[i].directionStopName.StopName.Zh_tw,srrivalDisplay:h({EstimateTime:o[c].EstimateTime,StopStatus:o[c].StopStatus,NextBusTime:o[c].NextBusTime}),estimateTime:o[c].EstimateTime||"",stopStatus:o[c].StopStatus,nextBusTime:o[c].NextBusTime||"",frequentStop:m({stopName:e[i].stopName,routeName:e[i].routeName,direction:e[i].direction})});L(n.nearestStationDisplay);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,a,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/Kaohsiung?%24format=JSON",t.next=3,fetch(n,{headers:b()}).then((function(t){return t.json()}));case 3:for(a=t.sent,o=[],i=0;i<a.length;i++)for(c=0;c<a[i].Stops.length;c++)a[i].Stops[c].StopPosition.PositionLat<=e.latTop&&a[i].Stops[c].StopPosition.PositionLat>=e.latDown&&a[i].Stops[c].StopPosition.PositionLon<=e.lngRight&&a[i].Stops[c].StopPosition.PositionLon>=e.lngLeft&&o.push({direction:a[i].Direction,position:[a[i].Stops[c].StopPosition.PositionLat,a[i].Stops[c].StopPosition.PositionLon],stopName:a[i].Stops[c].StopName.Zh_tw,routeName:a[i].RouteName.Zh_tw,directionStopName:a[i].Stops[a[i].Stops.length-1]});g(o);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.frequentData=[],e.getFrequentJudge(),a="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/Kaohsiung?%24format=JSON",t.next=5,fetch(a,{headers:b()}).then((function(t){return t.json()}));case 5:o=t.sent,n.frequentJudge.forEach((function(t){o.forEach((function(e){t.direction===e.Direction&&t.routeName===e.RouteName.Zh_tw&&t.stopName===e.StopName.Zh_tw&&n.frequentData.push({direction:t.direction,directionStopName:t.directionStopName,estimateTime:t.estimateTime,frequentStop:t.frequentStop,isLastBus:t.isLastBus,nextBusTime:t.nextBusTime,positionLat:t.positionLat,positionLon:t.positionLon,routeName:t.routeName,stopName:t.stopName,stopStatus:t.stopStatus,srrivalDisplay:h({EstimateTime:e.EstimateTime,StopStatus:e.StopStatus,NextBusTime:e.NextBusTime})})}))}));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){T(),q(),x(),n.listSwitch="frequentStop";var e=n.frequentJudge.length;if(0!==e){var a=Math.round(e/2);1===a&&(a=0);var o=[n.frequentJudge[a].positionLat,n.frequentJudge[a].positionLon];n.frequentJudge.forEach((function(e){var n=Xt.a.marker([e.positionLat,e.positionLon]);t.addLayer(n);var a=Xt.a.popup({minWidth:200});a.setContent("".concat(e.stopName)),n.bindPopup(a)})),t.setView(o,14)}},N=function(t){var e=Object(Wt["a"])({},t),a=[];"searchRoute_stop"===n.listSwitch&&(a=n.busArrivalData),"nearbyStation"===n.listSwitch&&(a=n.nearestStationDisplay),t.frequentStop?(a.forEach((function(e){t.stopName===e.stopName&&t.direction===e.direction&&t.routeName===e.routeName&&(e.frequentStop=!1)})),k(e)):(a.forEach((function(e){t.stopName===e.stopName&&t.direction===e.direction&&t.routeName===e.routeName&&(e.frequentStop=!0)})),e.frequentStop=!0,n.frequentJudge.push(e),localStorage.setItem("frequentJudge",JSON.stringify(n.frequentJudge)))},k=function(t){n.frequentJudge.forEach((function(e,a){e.directionStopName===t.directionStopName&&e.routeName===t.routeName&&e.stopName===t.stopName&&(n.frequentJudge.splice(a,1),n.frequentData.splice(a,1))})),localStorage.setItem("frequentJudge",JSON.stringify(n.frequentJudge)),"frequentStop"===n.listSwitch&&(q(),L(n.frequentJudge))},L=function(e){e.forEach((function(e){var n=Xt.a.marker([e.positionLat,e.positionLon]);t.addLayer(n);var a=Xt.a.popup({minWidth:200});a.setContent("".concat(e.stopName)),n.bindPopup(a)}))},q=function(){t.eachLayer((function(e){e instanceof Xt.a.Marker&&(t.removeLayer(e),t.closePopup())}))},T=function(){t.eachLayer((function(e){e instanceof Xt.a.Circle&&(t.removeLayer(e),t.closePopup())}))};return Object(Wt["a"])(Object(Wt["a"])({},Object(a["A"])(n)),{},{fliterRouteNumber:r,directionSwitch:s,routeSwitchToStop:u,goBacklist:l,fetchStation:f,getAuthorizationHeader:b,estimatedArrivalDisplay:h,timeArrayToString:v,itemPopup:O,gps:j,onLocationFound:S,getAllStationPosition:y,addFrequentStop:N,removeFrequentStop:k,frequentStopJudge:m,listSwitchControl:o,frequenStopMark:w,testfrequenStop:x})}};n("fa46");const Gt=m()(Ut,[["render",It]]);var $t=Gt,Qt=[{path:"/",name:"Home",component:$t}],Yt=Object(v["a"])({history:Object(v["b"])(),routes:Qt}),te=Yt;Object(a["c"])(h).use(te).mount("#app")},"8cec":function(t,e,n){},f7c4:function(t,e,n){},fa46:function(t,e,n){"use strict";n("8cec")}});
//# sourceMappingURL=index.880c539e.js.map